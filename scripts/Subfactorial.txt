

//* derangements of a set


ln10 = ln 10
// Y-axis will plot as logarithmic
!! l10(x) = ( ln x ) / ln10

// subfactorial formula
!! SF(x) = floor ( 0.5 + x ! / e )

// derangements of a set computed as subfactorial
!! dtf (x) = l10 ( SF(x) )

// plot beside the standard factorial
!! f(x) = l10 ( x! )

// almost linear on logarithmic plot
graph [ 2 < a < 20  ] ( f a, dtf a )

A000166 = ( 1, 0, 1, 2, 9, 44, 265, 1854, 14833, 133496, 1334961 )
ERRORS = [ 0 < n < LENGTH A000166 ] ( A000166 # n - SF n )
CALC ERRORS


// A000166		Subfactorial or rencontres numbers, or derangements: 
//			number of permutations of n elements with no fixed points.
// (Formerly M1937 N0766)		+20

// 0  1  2  3  4   5    6     7      8       9       10        11         12          13           14            15             16
// 1, 0, 1, 2, 9, 44, 265, 1854, 14833, 133496, 1334961, 14684570, 176214841, 2290792932, 32071101049, 481066515734, 7697064251745, 
//	130850092279664, 2355301661033953, 44750731559645106, 895014631192902121, 18795307255050944540, 413496759611120779881, 
//	9510425471055777937262

//	1						= ( 1 )
//	2						= ( 2 )
//	9						= ( 3^2 )
//	44						= ( 2^2 * 11 )
//	265						= ( 5 * 53 )
//	1854					= ( 2 * 3^2 * 103 )
//	14833					= ( 7 * 13 * 163 )
//	133496					= ( 2^3 * 11 * 37 * 41 )
//	1334961					= ( 3^4 * 16481 )
//	14684570				= ( 2 * 5 * 1468457 )
//	176214841				= ( 11^2 * 1456321 )
//	2290792932				= ( 2^2 * 3^2 * 457 * 139241 )
//	32071101049				= ( 13 * 1373 * 1796801 )
//	481066515734			= ( 2 * 7 * 34361893981 )
//	7697064251745			= ( 3^2 * 5 * 11 * 15549624751 )
//	130850092279664			= ( 2^4 * 17713 * 461702183 )
//	2355301661033953		= ( 17 * 2130617 * 65026777 )
//	44750731559645106		= ( 2 * 3^5 * 103 * 893977617157 )
//	895014631192902121		= ( 11 * 19 * 109 * 2237 * 17562703393 )


// factored operator for derangements
calc [ 0 <= x <= 16 ] ( x $! )

A000166 = ( 1, 0, 1, 2, 9, 44, 265, 1854, 14833, 133496, 1334961, 14684570, 176214841, 2290792932, 32071101049, 481066515734, 7697064251745 )
ERRORS = [ 0 < n < LENGTH A000166 ] ( A000166 # n - n $! )
CALC ERRORS

